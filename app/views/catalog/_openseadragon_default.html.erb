<div>
<% image = document.to_openseadragon(blacklight_config.view_config(:show)) %>
<% my_osd_config = {
          id:"kbOSDInstance",
          showNavigator:true,
          rtl:false,
          initialPage:1,
          defaultZoomLevel:0,
          sequenceMode:true,
          indexPage:[],
          tileSources: image
} %>
  <script type="text/javascript">
//    var kbOSDconfig = [<%#= raw  my_osd_config.to_json %>];
    var kbOSDconfig = [{
      id: 'myInstance',
      kbHeader: 'This is the title',
      showNavigator: true,
      rtl: true,
      //initialPage: 1,
      //hidePageNav: true,
      defaultZoomLevel: 0, // 0.34
      //minZoomLevel: 0.2,
      //maxZoomLevel: 2.0,
      sequenceMode: true,
      indexPage: [],
      tileSources: <%= image.to_s.html_safe %>

    }];

    if (kbOSDconfig[0].indexPage.length < 2) { // if there is only one element in the index, then don't show any index
      delete kbOSDconfig[0].indexPage;
    } else {
      $.each(kbOSDconfig[0].indexPage, function (index, indexPage) {
        if ('string' === typeof indexPage.page) {
          index.page = parseInt(index.page, 10);
        }
      });
    }

  </script>

  <div style="border:1px solid black;position:absolute;top:50px;left:20px;right:20px;bottom:20px">
    <div id="myInstance" style="height:100%">
      <div class="kbOSDViewer">
        <div class="kbOSDContent"></div>
        <div class="kbOSDFooter"></div>
      </div>
    </div>
  </div>


<script src="https://static.kb.dk/kbOpenSeadragon/js/KbOSD_bundle.js"></script>
<%# OpenSeadragon end %>
</div>